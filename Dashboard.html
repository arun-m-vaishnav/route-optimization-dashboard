<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Route Optimization Dashboard</title>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      padding: 20px;
    }

    h1 {
      margin-bottom: 15px;
    }

    .kpis {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .kpi {
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }

    .kpi h3 {
      font-size: 14px;
      color: #666;
      margin: 0;
    }

    .kpi p {
      font-size: 26px;
      font-weight: bold;
      margin: 6px 0 0;
    }

    .charts {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .card {
      background: #fff;
      padding: 15px;
      border-radius: 8px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
    }

    th, td {
      padding: 10px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }

    th {
      background: #f0f0f0;
    }
    
    .header-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 15px;
}

.export-actions {
  display: flex;
  gap: 10px;
}

button {
  padding: 8px 14px;
  border: none;
  border-radius: 6px;
  background: #1976d2;
  color: #fff;
  cursor: pointer;
}

button:hover {
  opacity: 0.9;
}


  </style>
</head>
<body>
<div class="header-row">
  <h1>ðŸšš Route Optimization Dashboard</h1>

  <div class="export-actions">
    <button onclick="exportPDF()">ðŸ“„ Export PDF</button>
    <button onclick="exportExcel()">ðŸ“Š Export Excel</button>
  </div>
</div>
<div id="dashboardContent">
<div id="kpiSection" class="kpis"></div>

<div class="charts">
  <div class="card">
    <h3>Distance per Vehicle (Km)</h3>
    <canvas id="distanceChart"></canvas>
  </div>

  <div class="card">
    <h3>Utilization (%)</h3>
    <canvas id="utilizationChart"></canvas>
  </div>
</div>

<div class="card">
  <h3>Vehicle Summary</h3>
  <table>
    <thead>
      <tr>
        <th>Vehicle</th>
        <th>Distance (Km)</th>
        <th>Stores</th>
        <th>Time (Hrs)</th>
        <th>Occupancy %</th>
        <th>Freezer %</th>
        <th>Chiller %</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>
</div>
</div>

<script>
/* =======================
   INPUT JSON DATA
======================= */
const data = [
  {
    "Date": "11/27/2025",
    "Vehicle Name": "TSTDHI02",
    "Total Capacity": 1000000,
    "Load": 21322.97,
    "Distance(Km)": 137.27,
    "Distance with Warehouse(Km)": 171.59,
    "Store Count": 13,
    "No of Invoices": 19,
    "BillAmount": 46123,
    "Total time(Hrs)": 8.91,
    "TSS(Hrs)": 4.33,
    "Occupancy": 2.13,
    "(%)Utilization(Freezer)": 35.9,
    "(%)Utilization(Chiller)": 63.33
  },
  {
    "Date": "11/27/2025",
    "Vehicle Name": "SHJ32157White",
    "Total Capacity": 6000,
    "Load": 5144.256,
    "Distance(Km)": 26.83,
    "Distance with Warehouse(Km)": 53.92,
    "Store Count": 4,
    "No of Invoices": 5,
    "BillAmount": 9271,
    "Total time(Hrs)": 2.23,
    "TSS(Hrs)": 1.33,
    "Occupancy": 85.74,
    "(%)Utilization(Freezer)": 25.61,
    "(%)Utilization(Chiller)": 70.43
  },
  {
    "Date": "11/27/2025",
    "Vehicle Name": "SHJ 52527/2",
    "Total Capacity": 4200,
    "Load": 3266.5378,
    "Distance(Km)": 7.73,
    "Distance with Warehouse(Km)": 14.08,
    "Store Count": 2,
    "No of Invoices": 3,
    "BillAmount": 7514,
    "Total time(Hrs)": 0.92,
    "TSS(Hrs)": 0.67,
    "Occupancy": 77.77,
    "(%)Utilization(Freezer)": 29.59,
    "(%)Utilization(Chiller)": 68.66
  },
  {
    "Date": "11/27/2025",
    "Vehicle Name": "SHJ 54946/2",
    "Total Capacity": 4200,
    "Load": 3431.9116,
    "Distance(Km)": 25.32,
    "Distance with Warehouse(Km)": 47.28,
    "Store Count": 3,
    "No of Invoices": 3,
    "BillAmount": 6378,
    "Total time(Hrs)": 1.84,
    "TSS(Hrs)": 1,
    "Occupancy": 81.71,
    "(%)Utilization(Freezer)": 20.26,
    "(%)Utilization(Chiller)": 72.04
  },
  {
    "Date": "11/27/2025",
    "Vehicle Name": "SHJ 16052 /1",
    "Total Capacity": 6000,
    "Load": 9587.4375,
    "Distance(Km)": 26.02,
    "Distance with Warehouse(Km)": 53.6,
    "Store Count": 1,
    "No of Invoices": 1,
    "BillAmount": 2007,
    "Total time(Hrs)": 1.2,
    "TSS(Hrs)": 0.33,
    "Occupancy": 89.79,
    "(%)Utilization(Freezer)": 0.9,
    "(%)Utilization(Chiller)": 99.1
  },
  {
    "Date": "11/27/2025",
    "Vehicle Name": "SHJ 96034 /2",
    "Total Capacity": 6000,
    "Load": 5343.1084,
    "Distance(Km)": 25.37,
    "Distance with Warehouse(Km)": 51.64,
    "Store Count": 2,
    "No of Invoices": 2,
    "BillAmount": 7984,
    "Total time(Hrs)": 1.51,
    "TSS(Hrs)": 0.67,
    "Occupancy": 89.05,
    "(%)Utilization(Freezer)": 17.32,
    "(%)Utilization(Chiller)": 66.86
  },
  {
    "Date": "11/27/2025",
    "Vehicle Name": "DXB 56812 N",
    "Total Capacity": 6000,
    "Load": 4992.6045,
    "Distance(Km)": 27.93,
    "Distance with Warehouse(Km)": 54.33,
    "Store Count": 2,
    "No of Invoices": 2,
    "BillAmount": 10051,
    "Total time(Hrs)": 1.6,
    "TSS(Hrs)": 0.67,
    "Occupancy": 83.21,
    "(%)Utilization(Freezer)": 22.15,
    "(%)Utilization(Chiller)": 65.99
  },
  {
    "Date": "11/27/2025",
    "Vehicle Name": "DXB 56821 N",
    "Total Capacity": 6000,
    "Load": 5093.3184,
    "Distance(Km)": 91.9,
    "Distance with Warehouse(Km)": 160.7,
    "Store Count": 3,
    "No of Invoices": 4,
    "BillAmount": 9155,
    "Total time(Hrs)": 4.06,
    "TSS(Hrs)": 1,
    "Occupancy": 84.89,
    "(%)Utilization(Freezer)": 21.85,
    "(%)Utilization(Chiller)": 56.3
  },
  {
    "Date": "11/27/2025",
    "Vehicle Name": "DXB 58240 N",
    "Total Capacity": 6000,
    "Load": 4770.0107,
    "Distance(Km)": 53.49,
    "Distance with Warehouse(Km)": 74.29,
    "Store Count": 3,
    "No of Invoices": 4,
    "BillAmount": 6207,
    "Total time(Hrs)": 2.78,
    "TSS(Hrs)": 1,
    "Occupancy": 79.5,
    "(%)Utilization(Freezer)": 88.42,
    "(%)Utilization(Chiller)": 11.58
  }
];

/* =======================
   KPI CALCULATIONS
======================= */
const sum = field => data.reduce((a, b) => a + (b[field] || 0), 0);

const kpis = [
  { label: 'Total Vehicles', value: data.length },
  { label: 'Total Distance (Km)', value: sum('Distance(Km)').toFixed(1) },
  { label: 'Avg Distance (Km)', value: (sum('Distance(Km)')/ data.length).toFixed(1) },
  { label: 'Total Stores', value: sum('Store Count') },
  { label: 'Total Invoices', value: sum('No of Invoices') },
  { label: 'Total Bill Amount', value: sum('BillAmount') },
  { label: 'Avg Time (Hrs)', value: (sum('Total time(Hrs)') / data.length).toFixed(1) },
  { label: 'Avg TSS (Hrs)', value: (sum('TSS(Hrs)') / data.length).toFixed(1) }
];

const kpiSection = document.getElementById('kpiSection');
kpis.forEach(k => {
  kpiSection.innerHTML += `
    <div class="kpi">
      <h3>${k.label}</h3>
      <p>${k.value}</p>
    </div>
  `;
});

/* =======================
   CHARTS
======================= */
const labels = data.map(v => v['Vehicle Name']);

new Chart(document.getElementById('distanceChart'), {
  type: 'bar',
  data: {
    labels,
    datasets: [{
      label: 'Distance (Km)',
      data: data.map(v => v['Distance(Km)'])
    }]
  }
});

new Chart(document.getElementById('utilizationChart'), {
  type: 'bar',
  data: {
    labels,
    datasets: [
      {
        label: 'Occupancy %',
        data: data.map(v => v['Occupancy'])
      },
      {
        label: 'Freezer Util %',
        data: data.map(v => v['(%)Utilization(Freezer)'])
      },
      {
        label: 'Chiller Util %',
        data: data.map(v => v['(%)Utilization(Chiller)'])
      }
    ]
  }
});

/* =======================
   TABLE
======================= */
const tbody = document.getElementById('tableBody');
data.forEach(v => {
  tbody.innerHTML += `
    <tr>
      <td>${v['Vehicle Name']}</td>
      <td>${v['Distance(Km)']}</td>
      <td>${v['Store Count']}</td>
      <td>${v['Total time(Hrs)']}</td>
      <td>${v['Occupancy']}</td>
      <td>${v['(%)Utilization(Freezer)']}</td>
      <td>${v['(%)Utilization(Chiller)']}</td>
    </tr>
  `;
});


function exportPDF() {
  const element = document.getElementById('dashboardContent');

  html2pdf().set({
    margin: 0.5,
    filename: 'Route_Optimization_Report.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'in', format: 'a4', orientation: 'landscape' }
  }).from(element).save();
}

function exportExcel() {
  const rows = data.map(v => ({
    Date: v.Date,
    Vehicle: v['Vehicle Name'],
    Distance_Km: v['Distance(Km)'],
    Distance_With_Warehouse_Km: v['Distance with Warehouse(Km)'],
    Stores: v['Store Count'],
    Invoices: v['No of Invoices'],
    Bill_Amount: v.BillAmount,
    Time_Hrs: v['Total time(Hrs)'],
    Occupancy_Percent: v.Occupancy,
    Freezer_Utilization: v['(%)Utilization(Freezer)'],
    Chiller_Utilization: v['(%)Utilization(Chiller)']
  }));

  const worksheet = XLSX.utils.json_to_sheet(rows);
  const workbook = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(workbook, worksheet, 'Routes');

  XLSX.writeFile(workbook, 'Route_Optimization_Data.xlsx');
}

</script>

</body>
</html>
